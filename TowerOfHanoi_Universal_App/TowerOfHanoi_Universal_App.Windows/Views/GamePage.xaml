<Page
    x:Class="TowerOfHanoi_Universal_App.Views.GamePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TowerOfHanoi_Universal_App.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    x:Name="TowerOfHanoi">

    <Page.Resources>

        <!--Tower of Hanoi Styles-->
        <Style x:Key="TowerOfHanoiLeaderBoardHeaderStyle" TargetType="TextBlock" BasedOn="{StaticResource TitleTextBlockStyle}">
            <Setter Property="TextAlignment" Value="Center" />
            <Setter Property="Width" Value="120" />
            <Setter Property="Margin" Value="20, 4" />
        </Style>
        <Style x:Key="TowerOfHanoiLeaderBoardTextStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyTextBlockStyle}">
            <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}" />
            <Setter Property="TextAlignment" Value="Center" />
            <Setter Property="Width" Value="120" />
            <Setter Property="Margin" Value="20, 4" />
        </Style>
        <Style x:Key="LevelSelectorButtonStyle" TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
            <Setter Property="FontSize" Value="96"/>
            <Setter Property="FontWeight" Value="Light"/>
            <Setter Property="FontFamily" Value="Segoe Script"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="LineHeight" Value="40"/>
        </Style>
        <Style x:Key="HeaderTextBlockStyle" TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
            <Setter Property="FontSize" Value="96"/>
            <Setter Property="FontWeight" Value="Light"/>
            <Setter Property="FontFamily" Value="Segoe Script"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="LineHeight" Value="40"/>
        </Style>
        <Style x:Key="SnappedPageHeaderTextStyle" TargetType="TextBlock" BasedOn="{StaticResource BaseTextBlockStyle}">
            <Setter Property="FontSize" Value="40"/>
            <Setter Property="FontWeight" Value="Light"/>
            <Setter Property="FontFamily" Value="Segoe Script"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!--Tower of Hanoi ListView Style-->
        <Style x:Key="TowerOfHanoiListViewStyle" TargetType="ListView">
            <Setter Property="Padding" Value="2"/>
            <Setter Property="Margin" Value="50, 10"/>
            <Setter Property="IsTabStop" Value="False"/>
            <Setter Property="TabNavigation" Value="Once"/>
            <Setter Property="AllowDrop" Value="True"/>
            <Setter Property="CanDragItems" Value="True"/>
            <Setter Property="CanReorderItems" Value="False"/>
            <Setter Property="IsSwipeEnabled" Value="True"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Disabled"/>
            <Setter Property="ScrollViewer.HorizontalScrollMode" Value="Disabled"/>
            <Setter Property="ScrollViewer.IsHorizontalRailEnabled" Value="False"/>
            <Setter Property="ScrollViewer.VerticalScrollMode" Value="Disabled"/>
            <Setter Property="ScrollViewer.IsVerticalRailEnabled" Value="False"/>
            <Setter Property="ScrollViewer.ZoomMode" Value="Disabled"/>
            <Setter Property="ScrollViewer.IsDeferredScrollingEnabled" Value="False"/>
            <Setter Property="ScrollViewer.BringIntoViewOnFocusChange" Value="False"/>
            <Setter Property="BorderThickness" Value="0,0,0,15"/>
            <Setter Property="BorderBrush" Value="White"/>
            <Setter Property="VerticalAlignment" Value="Bottom"/>
            <Setter Property="VerticalContentAlignment" Value="Bottom"/>
            <Setter Property="Height" Value="290"/>
            <Setter Property="Background">
                <Setter.Value>
                    <ImageBrush ImageSource="ms-appx:///Assets/Cloud_Pole.png" Stretch="Fill" />
                </Setter.Value>
            </Setter>
            <Setter Property="ItemContainerTransitions">
                <Setter.Value>
                    <TransitionCollection>
                        <EdgeUIThemeTransition/>
                    </TransitionCollection>
                </Setter.Value>
            </Setter>
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <VirtualizingStackPanel Orientation="Vertical" VerticalAlignment="Bottom"/>
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListView">
                        <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                            <ScrollViewer x:Name="ScrollViewer" BringIntoViewOnFocusChange="{TemplateBinding ScrollViewer.BringIntoViewOnFocusChange}" HorizontalScrollMode="{TemplateBinding ScrollViewer.HorizontalScrollMode}" HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}" IsHorizontalRailEnabled="{TemplateBinding ScrollViewer.IsHorizontalRailEnabled}" IsHorizontalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsHorizontalScrollChainingEnabled}" IsVerticalScrollChainingEnabled="{TemplateBinding ScrollViewer.IsVerticalScrollChainingEnabled}" IsVerticalRailEnabled="{TemplateBinding ScrollViewer.IsVerticalRailEnabled}" IsDeferredScrollingEnabled="{TemplateBinding ScrollViewer.IsDeferredScrollingEnabled}" TabNavigation="{TemplateBinding TabNavigation}" VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}" VerticalScrollMode="{TemplateBinding ScrollViewer.VerticalScrollMode}" ZoomMode="{TemplateBinding ScrollViewer.ZoomMode}">
                                <ItemsPresenter HeaderTemplate="{TemplateBinding HeaderTemplate}" Header="{TemplateBinding Header}" HeaderTransitions="{TemplateBinding HeaderTransitions}" Padding="{TemplateBinding Padding}"/>
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="ListViewItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="TabNavigation" Value="Local"/>
            <Setter Property="IsHoldingEnabled" Value="True"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListViewItem">
                        <ContentPresenter Margin="0"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--Tower of Hanoi GridView Style-->
        <FontFamily x:Key="ContentControlThemeFontFamily">Segoe</FontFamily>
        <x:Double x:Key="ControlContentThemeFontSize">12</x:Double>
        <Thickness x:Key="GridViewItemMargin">4</Thickness>
        <SolidColorBrush x:Key="CheckBoxBackgroundThemeBrush" Color="Transparent"/>
        <x:Double x:Key="CheckBoxBorderThemeThickness">2.5</x:Double>
        <x:Double x:Key="ListViewItemContentOffsetX">-40.5</x:Double>
        <Thickness x:Key="ListViewItemMultiselectCheckBoxMargin">0,9.5,0,0</Thickness>
        <Thickness x:Key="GridViewItemMultiselectBorderThickness">2.5</Thickness>
        <x:Double x:Key="ListViewItemDisabledThemeOpacity">0.4</x:Double>
        <x:Double x:Key="ListViewItemContentTranslateX">40.5</x:Double>
        <x:Double x:Key="ListViewItemReorderHintThemeOffset">32</x:Double>
        <SolidColorBrush x:Key="TowerofHanoiBorderBrush" Color="{ThemeResource SystemColorHighlightColor}" />
        <Style x:Key="TowerofHanoiGridViewItemStyle" TargetType="GridViewItem">
            <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}"/>
            <Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="TabNavigation" Value="Local"/>
            <Setter Property="IsHoldingEnabled" Value="False"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="Margin" Value="{ThemeResource GridViewItemMargin}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GridViewItem">
                        <Border x:Name="OuterContainer" RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <ScaleTransform x:Name="ContentScaleTransform"/>
                            </Border.RenderTransform>
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualStateGroup.Transitions>
                                        <VisualTransition From="Pressed" To="Normal">
                                            <Storyboard>
                                                <PointerUpThemeAnimation Storyboard.TargetName="TiltContainer"/>
                                            </Storyboard>
                                        </VisualTransition>
                                    </VisualStateGroup.Transitions>
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="Pressed">
                                        <Storyboard>
                                            <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SelectedBorder"/>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>

                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Unselected"/>
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="SelectedBorder"/>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Grid x:Name="ReorderHintContent" Background="Transparent">
                                <Border x:Name="CheckboxTiltContainer" HorizontalAlignment="Left" Margin="{ThemeResource ListViewItemMultiselectCheckBoxMargin}" VerticalAlignment="Top">
                                    <Border x:Name="CheckboxOuterContainer">
                                        <Border.Clip>
                                            <RectangleGeometry Rect="0,0,25.5,25.5"/>
                                        </Border.Clip>
                                        <Grid x:Name="CheckboxContainer">
                                            <Grid.RenderTransform>
                                                <TranslateTransform x:Name="CheckboxContainerTranslateTransform" X="{ThemeResource ListViewItemContentOffsetX}"/>
                                            </Grid.RenderTransform>
                                            <Rectangle x:Name="NormalRectangle" Fill="{ThemeResource CheckBoxBackgroundThemeBrush}" Height="25.5" Stroke="{ThemeResource CheckBoxBorderThemeBrush}" StrokeThickness="{ThemeResource CheckBoxBorderThemeThickness}" Width="25.5"/>
                                            <Path x:Name="CheckGlyph" Data="M0,123 L39,93 L124,164 L256,18 L295,49 L124,240 z" Fill="{ThemeResource CheckBoxForegroundThemeBrush}" FlowDirection="LeftToRight" HorizontalAlignment="Center" Height="17" IsHitTestVisible="False" Opacity="0" Stretch="Fill" StrokeThickness="2.5" StrokeLineJoin="Round" VerticalAlignment="Center" Width="18.5"/>
                                        </Grid>
                                    </Border>
                                </Border>
                                <Border x:Name="ContentContainer">
                                    <Border x:Name="TiltContainer">
                                        <Border x:Name="ContentBorder" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                                            <Border.RenderTransform>
                                                <TranslateTransform x:Name="ContentBorderTranslateTransform"/>
                                            </Border.RenderTransform>
                                            <Grid>
                                                <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTransitions="{TemplateBinding ContentTransitions}" Content="{TemplateBinding Content}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                                <TextBlock x:Name="PlaceholderTextBlock" AutomationProperties.AccessibilityView="Raw" Foreground="{x:Null}" IsHitTestVisible="False" Margin="{TemplateBinding Padding}" Opacity="0" Text="Xg"/>
                                                <Rectangle x:Name="PlaceholderRect" Fill="{ThemeResource ComboBoxPlaceholderTextForegroundThemeBrush}" IsHitTestVisible="False" Visibility="Collapsed"/>
                                            </Grid>
                                        </Border>
                                    </Border>
                                </Border>
                                <Border x:Name="SelectedBorder" BorderBrush="{ThemeResource TowerofHanoiBorderBrush}" BorderThickness="4" IsHitTestVisible="False" Opacity="0">
                                    <Grid x:Name="SelectedCheckMark" HorizontalAlignment="Right" Height="34" VerticalAlignment="Top" Width="34">
                                        <Path x:Name="SelectedEarmark" Data="M0,0 L40,0 L40,40 z" Fill="{ThemeResource TowerofHanoiBorderBrush}" Stretch="Fill"/>
                                        <Path x:Name="SelectedGlyph" Data="M0,123 L39,93 L124,164 L256,18 L295,49 L124,240 z" Fill="White" FlowDirection="LeftToRight" HorizontalAlignment="Right" Height="14.5" Margin="0,1,1,0" Stretch="Fill" VerticalAlignment="Top" Width="17"/>
                                    </Grid>
                                </Border>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--Tower of Hanoi Templates-->
        <ItemsPanelTemplate x:Key="TowerofHanoiGridViewItemsPanel">
            <VariableSizedWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="3"/>
        </ItemsPanelTemplate>
        <DataTemplate x:Key="Standard300x300ItemTemplate">
            <Rectangle RadiusX="10" RadiusY="10" Height="{Binding Height}" Width="{Binding Width}" AllowDrop="{Binding IsDraggable}" Fill="{Binding Brush}" />
        </DataTemplate>
        <DataTemplate x:Key="Filled300x300ItemTemplate">
            <Rectangle RadiusX="10" RadiusY="10" Height="{Binding Height}" Width="{Binding Width,Converter={StaticResource DiskWidthConverter},ConverterParameter=15, Mode=OneWay}" AllowDrop="{Binding IsDraggable}" Fill="{Binding Brush}" />
        </DataTemplate>
        <DataTemplate x:Key="Narrow150x300ItemTemplate">
            <Rectangle RadiusX="10" RadiusY="10" Height="24" Width="{Binding Width,Converter={StaticResource DiskWidthConverter},ConverterParameter=0, Mode=OneWay}" AllowDrop="{Binding IsDraggable}" Fill="{Binding Brush}" />
        </DataTemplate>

    </Page.Resources>

    <Page.BottomAppBar>
        <CommandBar  IsOpen="{Binding GameSettings.IsAppbarSticky}" IsSticky="{Binding GameSettings.IsAppbarSticky}">
            <CommandBar.PrimaryCommands>
                <AppBarButton
                          ToolTipService.ToolTip="Help" 
                          Icon="Help"
                          Label="help"
                          IsCompact="True">
                    <AppBarButton.Flyout>
                        <Flyout>
                            <Flyout.FlyoutPresenterStyle>
                                <Style TargetType="FlyoutPresenter">
                                    <Setter Property="Background" Value="White"/>
                                    <Setter Property="BorderBrush" Value="Transparent"/>
                                </Style>
                            </Flyout.FlyoutPresenterStyle>
                            <StackPanel Width="Auto" Margin="20">
                                <TextBlock Style="{ThemeResource SubheaderTextBlockStyle}" Text="INSTRUCTIONS"/>
                                <TextBlock Style="{StaticResource BodyTextBlockStyle}" LineHeight="30">
                            	<Run Text="1. Only one disk should be moved at a time."/>
                            	<LineBreak/>
                            	<Run Text="2. Each move consists of taking the top disk from one of the poles and sliding it onto another pole."/>
                            	<LineBreak/>
                            	<Run Text="3. No disk can be placed on top of a smaller disk."/>
                            	<LineBreak/>
                            	<Run Text="4. End of game comes when you move all the disk from Pole A to Pole C."/>
                            	<LineBreak/>
                                <Run Text="5. Player moves detail shows the moves of the player."/>
                            	<LineBreak/>
                            	<Run Text="6. Explore game settings for some more options."/>
                            	<LineBreak/>
                                </TextBlock>
                            </StackPanel>
                        </Flyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
                <AppBarButton
                    ToolTipService.ToolTip="Enable/Disable game sounds"
                    Icon="{Binding GameSettings.IsGameSoundEnabled, Converter={StaticResource IconConverter}, Mode=OneWay}"
                    Label="sound"
                    Command="{Binding GameSoundSettingsCommand}"
                    IsCompact="True"/>
                <AppBarButton
                    x:Name="BtnUndo"
                    ToolTipService.ToolTip="Undo last move" 
                    Icon="Undo" 
                    Label="undo"
                    IsCompact="True"
                    IsEnabled="{Binding CanUndoLastMove}"
                    Command="{Binding UndoLastMoveCommand}"
                    Tapped="BtnUndo_Tapped"/>
                <AppBarButton
                          ToolTipService.ToolTip="Restart level" 
                          Icon="Refresh"
                          Label="restart"
                          IsCompact="True"
                          Command="{Binding RestartLevelCommand}"/>
            </CommandBar.PrimaryCommands>
            <CommandBar.SecondaryCommands>
                <AppBarButton
                    x:Name="BtnGotoPrevLevel"
                    ToolTipService.ToolTip="Go to Previous level" 
                    Icon="Back" 
                    Label="previous level"
                    IsCompact="True"
                    IsEnabled="{Binding CanGoToPreviousLevel}"
                    Command="{Binding GotoPreviousLevelCommand}"/>
                <AppBarButton
                    x:Name="BtnGotoNextLevel"
                    ToolTipService.ToolTip="Go to Next level" 
                    Icon="Forward" 
                    Label="next level"
                    IsCompact="True"
                    IsEnabled="{Binding CanGoToNextLevel}"
                    Command="{Binding GotoNextLevelCommand}"/>
                <AppBarButton
                    ToolTipService.ToolTip="Choose level" 
                    Icon="Go"
                    Label="choose level"
                    IsCompact="True">
                    <AppBarButton.Flyout>
                        <Flyout x:Name="LevelChooser" Placement="Top" Opening="Level_Chooser_Flyout_Opened">
                            <Flyout.FlyoutPresenterStyle>
                                <Style TargetType="FlyoutPresenter">
                                    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
                                    <Setter Property="Background" Value="White"/>
                                    <Setter Property="BorderBrush" Value="Transparent"/>
                                </Style>
                            </Flyout.FlyoutPresenterStyle>
                            <Grid Margin="4">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Margin="0,0,0,10" Grid.Column="1" Text="CHOOSE LEVEL" Style="{ThemeResource SubheaderTextBlockStyle}"/>
                                <GridView x:Name="LevelChooserGrid"
                                          Grid.Row="1" Grid.Column="1"
                                          Margin="5"
                                          VerticalAlignment="Top"
                                          SelectionMode="Single"
                                          IsItemClickEnabled="True"
                                          IsSwipeEnabled="True"
                                          IsRightTapEnabled="True"
                                          HorizontalAlignment="Center"
                                          ItemClick="LevelChooserGrid_ItemClick"
                                          ItemsPanel="{StaticResource TowerofHanoiGridViewItemsPanel}" 
                                          ItemContainerStyle="{StaticResource TowerofHanoiGridViewItemStyle}">
                                    <GridView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid Height="60" Width="60">
                                                <TextBlock Style="{ThemeResource BaseTextBlockStyle}" 
                                                           Text="{Binding}" TextAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Grid>
                                        </DataTemplate>
                                    </GridView.ItemTemplate>
                                </GridView>
                            </Grid>
                        </Flyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
                <AppBarButton
                    ToolTipService.ToolTip="Choose theme" 
                    Icon="BrowsePhotos"
                    Label="choose theme"
                    IsCompact="True">
                    <AppBarButton.Flyout>
                        <Flyout x:Name="ThemeChooser" Placement="Top">
                            <Flyout.FlyoutPresenterStyle>
                                <Style TargetType="FlyoutPresenter">
                                    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
                                    <Setter Property="Background" Value="White"/>
                                    <Setter Property="BorderBrush" Value="Transparent"/>
                                </Style>
                            </Flyout.FlyoutPresenterStyle>
                            <Grid Margin="4">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Margin="0,0,0,10" Grid.Row="0" Grid.Column="1" Text="CHOOSE THEME" Style="{ThemeResource SubheaderTextBlockStyle}"/>
                                <GridView x:Name="ThemeChooserGrid"
                                          Grid.Row="1" Grid.Column="1" 
                                          ItemClick="ThemeChooserGrid_ItemClick"
                                          SelectionMode="Single"
                                          IsSwipeEnabled="True"
                                          IsRightTapEnabled="True"
                                          IsItemClickEnabled="True"
                                          HorizontalAlignment="Center"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                          ScrollViewer.HorizontalScrollMode="Disabled"
                                          ItemContainerStyle="{StaticResource TowerofHanoiGridViewItemStyle}"
                                          ItemsPanel="{StaticResource TowerofHanoiGridViewItemsPanel}">
                                    <GridView.Items>
                                        <GridViewItem >
                                            <Image Tag="0" Height="140" Width="200" Source="ms-appx:///Assets/Day_Theme.png" Stretch="UniformToFill" />
                                        </GridViewItem>
                                        <GridViewItem>
                                            <Image Tag="1" Height="140" Width="200" Source="ms-appx:///Assets/Night_Theme.png" Stretch="UniformToFill" />
                                        </GridViewItem>
                                    </GridView.Items>
                                </GridView>
                            </Grid>
                        </Flyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
                <AppBarButton
                    ToolTipService.ToolTip="Leaderboards" 
                    Icon="Bullets"
                    Label="leaderboards"
                    IsCompact="True">
                    <AppBarButton.Flyout>
                        <Flyout x:Name="LeaderBoards" Placement="Top" Opening="Leaderboard_Flyout_Opened">
                            <Flyout.FlyoutPresenterStyle>
                                <Style TargetType="FlyoutPresenter">
                                    <Setter Property="Background" Value="White"/>
                                    <Setter Property="BorderBrush" Value="Transparent"/>
                                </Style>
                            </Flyout.FlyoutPresenterStyle>
                            <Grid Margin="4">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="60"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Margin="0,0,0,10" Grid.Row="0" Grid.Column="0" Text="LEADERBOARDS" Style="{ThemeResource SubheaderTextBlockStyle}"/>
                                <ListView x:Name="LeaderboardGrid"
                                          IsHitTestVisible="False"
                                          Grid.Row="1" Grid.Column="0"
                                          HorizontalAlignment="Center"
                                          HorizontalContentAlignment="Center">
                                    <ListView.Header>
                                        <StackPanel DataContext="{Binding}" Orientation="Horizontal">
                                            <TextBlock Style="{ThemeResource TowerOfHanoiLeaderBoardHeaderStyle}" Text="LEVEL"/>
                                            <TextBlock Style="{ThemeResource TowerOfHanoiLeaderBoardHeaderStyle}" Text="BEST MOVES"/>
                                            <TextBlock Style="{ThemeResource TowerOfHanoiLeaderBoardHeaderStyle}" Width="150" Text="PLAYER MOVES"/>
                                        </StackPanel>
                                    </ListView.Header>
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel DataContext="{Binding}" Orientation="Horizontal">
                                                <TextBlock Style="{ThemeResource TowerOfHanoiLeaderBoardTextStyle}" Text="{Binding Level}"/>
                                                <TextBlock Style="{ThemeResource TowerOfHanoiLeaderBoardTextStyle}" Text="{Binding BestMoves}"/>
                                                <TextBlock Style="{ThemeResource TowerOfHanoiLeaderBoardTextStyle}" Text="{Binding PlayerMoves, Converter={StaticResource PlayerMoveConverter}, Mode=OneWay}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Grid>
                        </Flyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
                <AppBarButton
                    ToolTipService.ToolTip="Rate and Review" 
                    Icon="LikeDislike"
                    Label="rate and review"
                    Tapped="RateAndReviewButtonTapped">
                </AppBarButton>
            </CommandBar.SecondaryCommands>
        </CommandBar>
    </Page.BottomAppBar>

    <Grid x:Name="GamePageGrid">
        <Grid.Background>
            <ImageBrush ImageSource="{Binding GameSettings.GameTheme, Converter={StaticResource ThemeConverter}, Mode=OneWay}" Stretch="UniformToFill" />
        </Grid.Background>
        <Grid.ChildrenTransitions>
            <TransitionCollection>
                <ContentThemeTransition/>
            </TransitionCollection>
        </Grid.ChildrenTransitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="140"/>
            <RowDefinition Height="100"/>
            <RowDefinition Height="75"/>
            <RowDefinition Height="3*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <MediaElement x:Name="DiskDrop" AutoPlay="False"
                      Source="ms-appx:///Assets/DiskDrop.wav"/>
        <MediaElement x:Name="LevelCompleted" AutoPlay="False"
                      Source="ms-appx:///Assets/LevelCompleted.wav"/>

        <TextBlock x:Name="PageTitle" 
                   Grid.Row="0" Grid.Column="0"
                   IsHitTestVisible="False" 
                   VerticalAlignment="Bottom" Margin="120,0,30,40" 
                   Text="{StaticResource AppName}"
                   Style="{ThemeResource HeaderTextBlockStyle}"/>

        <TextBlock x:Name="TxtInfo" 
                   Grid.Row="0" Grid.Column="0"
                   IsHitTestVisible="False" 
                   HorizontalAlignment="Right"
                   VerticalAlignment="Bottom" Margin="120,0,30,40" 
                   Text="" />

        <Grid x:Name="GameInfoStackPanel" 
              Grid.Row="1" Grid.Column="0" 
              HorizontalAlignment="Stretch" VerticalAlignment="Center" 
              Margin="10">
            <Grid.ChildrenTransitions>
                <TransitionCollection>
                    <ReorderThemeTransition/>
                </TransitionCollection>
            </Grid.ChildrenTransitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <Grid Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Image Source="ms-appx:///Assets/Cloud2.png" Stretch="Fill" />
                <TextBlock x:Name="TxtBestMoves"
                       Text="{Binding BestMoves, Converter={StaticResource GameValueConverter},ConverterParameter=1, Mode=OneWay}"
                       Style="{ThemeResource TowerOfHanoiInfoTextBlockStyle}"/>
            </Grid>
            <Grid Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Image Source="ms-appx:///Assets/Cloud2.png" Stretch="Fill" />
                <TextBlock x:Name="TxtCurrentLevel"
                       Text="{Binding CurrentLevel, Converter={StaticResource GameValueConverter},ConverterParameter=2, Mode=OneWay}"
                       Style="{ThemeResource TowerOfHanoiInfoTextBlockStyle}"/>
            </Grid>
            <Grid Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Image Source="ms-appx:///Assets/Cloud2.png" Stretch="Fill" />
                <TextBlock x:Name="TxtPlayerMoves"
                       Text="{Binding PlayerMoves, Converter={StaticResource GameValueConverter},ConverterParameter=3, Mode=OneWay}"
                       Style="{ThemeResource TowerOfHanoiInfoTextBlockStyle}"/>
            </Grid>
        </Grid>

        <ScrollViewer x:Name="PlayerMoveDetails"
                      Grid.Row="2" Grid.Column="0" Margin="10"
                      VerticalScrollBarVisibility="Auto"
                      VerticalScrollMode="Auto"
                      ZoomMode="Disabled"
                      Visibility="{Binding GameSettings.IsPlayerMoveDetailsVisible, Converter={StaticResource BoolToVisibilityConverter}, Mode=OneWay}" 
                      Background="Transparent">
            <ScrollViewer.TopLeftHeader>
                <TextBlock x:Name="PlayerMoveDetailsLabel"
                           Text="Player moves detail" HorizontalAlignment="Left"
                           Style="{ThemeResource TowerOfHanoiTitleTextBlockStyle}"/>
            </ScrollViewer.TopLeftHeader>
            <ScrollViewer.Transitions>
                <TransitionCollection>
                    <ReorderThemeTransition/>
                </TransitionCollection>
            </ScrollViewer.Transitions>
            <TextBlock x:Name="PlayerMoveDetailsText"
                       Text="{Binding PlayerMoveDetailText}" Margin="10"
                       HorizontalAlignment="Left"
                       VerticalAlignment="Top"
                       Style="{ThemeResource BodyTextBlockStyle}"
                       FontSize="20"
                       Foreground="White"
                       FontFamily="Segoe"/>
        </ScrollViewer>

        <Grid x:Name="GameGrid" 
              Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Margin="10" 
              HorizontalAlignment="Center">

            <Grid.ChildrenTransitions>
                <TransitionCollection>
                    <ReorderThemeTransition/>
                </TransitionCollection>
            </Grid.ChildrenTransitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="1" Grid.Column="0"
                           Text="Pole A"
                           Style="{ThemeResource  TowerOfHanoiTitleTextBlockStyle}" Foreground="#FFF3F3F3" FontSize="42.667" FontFamily="Buxton Sketch"/>
            <TextBlock Grid.Row="1" Grid.Column="1"
                           Text="Pole B"
                           Style="{ThemeResource TowerOfHanoiTitleTextBlockStyle}" Foreground="#FFF3F3F3" FontSize="42.667" FontFamily="Buxton Sketch"/>
            <TextBlock Grid.Row="1" Grid.Column="2"
                           Text="Pole C"
                           Style="{ThemeResource TowerOfHanoiTitleTextBlockStyle}" Foreground="#FFF3F3F3" FontSize="42.667" FontFamily="Buxton Sketch"/>

            <ListView x:Name="PoleA"
                      Tag="A" Grid.Row="0" Grid.Column="0"
                      ItemsSource="{Binding PoleADisks}"
                      DragItemsStarting="ListViewBase_OnDragItemsStarting" Drop="UIElement_OnDrop" Style="{StaticResource TowerOfHanoiListViewStyle}"
                      ItemTemplate="{Binding Source={StaticResource Standard300x300ItemTemplate}}">
            </ListView>
            <ListView x:Name="PoleB"
                      Tag="B" Grid.Row="0" Grid.Column="1"
                      ItemsSource="{Binding PoleBDisks}"
                      DragItemsStarting="ListViewBase_OnDragItemsStarting" Drop="UIElement_OnDrop" Style="{StaticResource TowerOfHanoiListViewStyle}"
                      ItemTemplate="{Binding Source={StaticResource Standard300x300ItemTemplate}}" />
            <ListView x:Name="PoleC"
                      Tag="C" Grid.Row="0" Grid.Column="2"
                      ItemsSource="{Binding PoleCDisks}"
                      DragItemsStarting="ListViewBase_OnDragItemsStarting" Drop="UIElement_OnDrop" Style="{StaticResource TowerOfHanoiListViewStyle}"
                      ItemTemplate="{Binding Source={StaticResource Standard300x300ItemTemplate}}" />
        </Grid>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="ApplicationViewStates">
                <VisualState x:Name="FullScreenLandscape"/>
                <VisualState x:Name="Filled">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleA" Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="250"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleB" Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="250"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleC" Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="250"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="Narrow">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="TxtBestMoves" Storyboard.TargetProperty="FontSize">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="12"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="TxtCurrentLevel" Storyboard.TargetProperty="FontSize">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="12"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="TxtPlayerMoves" Storyboard.TargetProperty="FontSize">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="12"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PageTitle" Storyboard.TargetProperty="Margin">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="60,0,15,40"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PageTitle" Storyboard.TargetProperty="Style">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SnappedPageHeaderTextStyle}"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleA" Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="150"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleB" Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="150"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleC" Storyboard.TargetProperty="Width">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="150"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleA" Storyboard.TargetProperty="Margin">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="6"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleB" Storyboard.TargetProperty="Margin">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="6"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PoleC" Storyboard.TargetProperty="Margin">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="6"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PlayerMoveDetailsLabel" Storyboard.TargetProperty="FontSize">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="18"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PlayerMoveDetailsText" Storyboard.TargetProperty="FontSize">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="14"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Page>
